@{
    ViewBag.Title = "Chat MÃ©dico IA";
    Layout = "~/Views/Shared/_LayoutPaciente.cshtml";
}

<style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #f0f2f5;
    }

    .chat-page-container {
        max-width: 1100px;
        margin: 0 auto;
        padding: 20px;
    }

    .chat-wrapper {
        background: white;
        border-radius: 16px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        overflow: hidden;
        height: calc(100vh - 200px);
        display: flex;
        flex-direction: column;
    }

    /* Header del Chat */
    .chat-header {
        background: linear-gradient(135deg, #0084ff 0%, #0063d1 100%);
        color: white;
        padding: 20px 24px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .chat-header-left {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .bot-avatar {
        width: 44px;
        height: 44px;
        background: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        color: #0084ff;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .bot-info h3 {
        font-size: 16px;
        font-weight: 600;
        margin: 0 0 4px 0;
    }

    .bot-status {
        font-size: 12px;
        opacity: 0.9;
        display: flex;
        align-items: center;
        gap: 6px;
    }

    .status-online {
        width: 8px;
        height: 8px;
        background: #4ade80;
        border-radius: 50%;
        box-shadow: 0 0 0 2px rgba(74, 222, 128, 0.3);
        animation: pulse-dot 2s infinite;
    }

    @@keyframes pulse-dot {
        0%, 100% { 
            transform: scale(1); 
            opacity: 1; 
        }
        50% { 
            transform: scale(1.1); 
            opacity: 0.8; 
        }
    }

    /* Ãrea de Mensajes */
    .chat-messages {
        flex: 1;
        padding: 24px;
        overflow-y: auto;
        background: #f8f9fa;
        background-image: 
            linear-gradient(90deg, rgba(200, 200, 200, 0.05) 1px, transparent 1px),
            linear-gradient(rgba(200, 200, 200, 0.05) 1px, transparent 1px);
        background-size: 20px 20px;
    }

    .message {
        display: flex;
        margin-bottom: 16px;
        animation: message-appear 0.3s ease-out;
    }

    @@keyframes message-appear {
        from {
            opacity: 0;
            transform: translateY(10px) scale(0.95);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    .message.user {
        justify-content: flex-end;
    }

    .message.bot {
        justify-content: flex-start;
    }

    .message-bubble {
        max-width: 65%;
        padding: 12px 16px;
        border-radius: 18px;
        position: relative;
        word-wrap: break-word;
        line-height: 1.5;
    }

    .message.user .message-bubble {
        background: #0084ff;
        color: white;
        border-bottom-right-radius: 4px;
        box-shadow: 0 1px 3px rgba(0, 132, 255, 0.3);
    }

    .message.bot .message-bubble {
        background: white;
        color: #1c1e21;
        border-bottom-left-radius: 4px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        border: 1px solid #e4e6eb;
    }

    .message-time {
        font-size: 11px;
        margin-top: 6px;
        opacity: 0.7;
        text-align: right;
    }

    .message.bot .message-time {
        color: #65676b;
    }

    .message.user .message-time {
        color: rgba(255, 255, 255, 0.9);
    }

    .badge-urgencia {
        padding: 6px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
        background: #ffc107;
        color: #000;
    }

    /* Indicador de escritura */
    .typing-indicator {
        display: none;
        padding: 12px 18px;
        background: white;
        border-radius: 18px;
        border-bottom-left-radius: 4px;
        width: fit-content;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        border: 1px solid #e4e6eb;
    }

    .typing-indicator.show {
        display: flex;
        gap: 4px;
        align-items: center;
    }

    .typing-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #90949c;
        animation: typing-bounce 1.4s infinite ease-in-out;
    }

    .typing-dot:nth-child(1) { animation-delay: 0s; }
    .typing-dot:nth-child(2) { animation-delay: 0.2s; }
    .typing-dot:nth-child(3) { animation-delay: 0.4s; }

    @@keyframes typing-bounce {
        0%, 60%, 100% { 
            transform: translateY(0); 
        }
        30% { 
            transform: translateY(-8px); 
        }
    }

    /* Input de Mensaje */
    .chat-input-area {
        padding: 16px 24px;
        background: white;
        border-top: 1px solid #e4e6eb;
    }

    .chat-input-wrapper {
        display: flex;
        gap: 12px;
        align-items: flex-end;
    }

    .chat-input {
        flex: 1;
        padding: 12px 16px;
        border: 1px solid #ccd0d5;
        border-radius: 20px;
        font-size: 15px;
        outline: none;
        transition: all 0.2s;
        resize: none;
        font-family: inherit;
        line-height: 1.4;
        max-height: 100px;
    }

    .chat-input:focus {
        border-color: #0084ff;
        box-shadow: 0 0 0 2px rgba(0, 132, 255, 0.1);
    }

    .send-button {
        width: 40px;
        height: 40px;
        background: #0084ff;
        border: none;
        border-radius: 50%;
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
        flex-shrink: 0;
    }

    .send-button:hover {
        background: #0063d1;
        transform: scale(1.05);
    }

    .send-button:active {
        transform: scale(0.95);
    }

    .send-button:disabled {
        background: #e4e6eb;
        cursor: not-allowed;
    }

    .send-button svg {
        width: 18px;
        height: 18px;
    }

    /* Estado vacÃ­o */
    .empty-state {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100%;
        color: #65676b;
        text-align: center;
        padding: 40px;
    }

    .empty-state-icon {
        font-size: 64px;
        color: #e4e6eb;
        margin-bottom: 16px;
    }

    .empty-state-title {
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 8px;
        color: #1c1e21;
    }

    .empty-state-text {
        font-size: 14px;
        color: #65676b;
        line-height: 1.6;
    }

    /* Scrollbar personalizado */
    .chat-messages::-webkit-scrollbar {
        width: 6px;
    }

    .chat-messages::-webkit-scrollbar-track {
        background: transparent;
    }

    .chat-messages::-webkit-scrollbar-thumb {
        background: #ccd0d5;
        border-radius: 3px;
    }

    .chat-messages::-webkit-scrollbar-thumb:hover {
        background: #b0b3b8;
    }

    /* Responsive */
    @@media (max-width: 768px) {
        .chat-wrapper {
            height: calc(100vh - 150px);
            border-radius: 0;
        }

        .message-bubble {
            max-width: 80%;
        }

        .chat-page-container {
            padding: 0;
        }
    }
</style>

<div class="chat-page-container">
    <div class="chat-wrapper">
        <!-- Header -->
        <div class="chat-header">
            <div class="chat-header-left">
                <div class="bot-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="bot-info">
                    <h3>Asistente MÃ©dico Virtual</h3>
                    <div class="bot-status">
                        <span class="status-online"></span>
                        <span>En lÃ­nea - EvaluaciÃ³n de SÃ­ntomas</span>
                    </div>
                </div>
            </div>
            <div>
                <span class="badge-urgencia">
                    <i class="fas fa-exclamation-triangle"></i> 2 - Moderado
                </span>
            </div>
        </div>

        <!-- Mensajes -->
        <div class="chat-messages" id="chatMessages">
            <div class="message bot">
                <div class="message-bubble">
                    ğŸ‘‹ Â¡Hola! Soy tu asistente mÃ©dico virtual. Estoy aquÃ­ para ayudarte con una evaluaciÃ³n inicial de tus sÃ­ntomas. Â¿QuÃ© molestias presentas hoy?
                    <div class="message-time">10:15</div>
                </div>
            </div>
            
            <div class="message user">
                <div class="message-bubble">
                    Hola, tengo dolor de cabeza y fiebre.
                    <div class="message-time">10:15</div>
                </div>
            </div>

            <div class="message bot">
                <div class="message-bubble">
                    Entiendo. El dolor de cabeza y la fiebre pueden tener varias causas. Para poder ayudarte mejor, necesito hacerte algunas preguntas:<br><br>
                    1ï¸âƒ£ Â¿Desde cuÃ¡ndo presentas estos sÃ­ntomas?<br>
                    2ï¸âƒ£ Â¿Has medido tu temperatura? Â¿CuÃ¡ntos grados tienes?
                    <div class="message-time">10:16</div>
                </div>
            </div>

            <div class="message user">
                <div class="message-bubble">
                    Desde hace 2 dÃ­as. SÃ­, 38.5Â°C.
                    <div class="message-time">10:17</div>
                </div>
            </div>

            <div class="message bot">
                <div class="message-bubble">
                    Gracias por la informaciÃ³n. Una fiebre de 38.5Â°C es moderada. Ahora necesito saber:<br><br>
                    â€¢ Â¿Tienes otros sÃ­ntomas como tos, dolor muscular, cansancio o dolor de garganta?<br>
                    â€¢ Â¿Has estado en contacto con personas enfermas recientemente?
                    <div class="message-time">10:17</div>
                </div>
            </div>

            <div class="message user">
                <div class="message-bubble">
                    Solo dolor muscular. No he estado con personas enfermas.
                    <div class="message-time">10:18</div>
                </div>
            </div>

            <div class="message bot">
                <div class="message-bubble">
                    <strong>ğŸ“‹ EvaluaciÃ³n Completada</strong><br><br>
                    BasÃ¡ndome en tus sÃ­ntomas (fiebre 38.5Â°C, dolor de cabeza, dolor muscular por 2 dÃ­as), mi evaluaciÃ³n es:<br><br>
                    <strong>ğŸŸ¡ Nivel de urgencia:</strong> <span class="badge-urgencia">2 - Moderado</span><br><br>
                    <strong>ğŸ’Š Recomendaciones:</strong><br>
                    â€¢ Solicita cita mÃ©dica en las prÃ³ximas 24-48 horas<br>
                    â€¢ Mantente hidratado (bebe abundante agua)<br>
                    â€¢ Descansa lo suficiente<br>
                    â€¢ Puedes tomar paracetamol para la fiebre (segÃºn indicaciÃ³n mÃ©dica)<br>
                    â€¢ Monitorea tu temperatura cada 4-6 horas<br><br>
                    âš ï¸ <strong>Acude a urgencias si:</strong> La fiebre supera 39Â°C, aparece dificultad respiratoria o los sÃ­ntomas empeoran.
                    <div class="message-time">10:18</div>
                </div>
            </div>
        </div>

        <!-- Input -->
        <div class="chat-input-area">
            <div class="chat-input-wrapper">
                <input type="text" 
                       class="chat-input" 
                       id="mensajeInput" 
                       placeholder="Escribe tu sÃ­ntoma o pregunta..."
                       autocomplete="off">
                <button class="send-button" id="btnEnviar" type="button">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                </button>
            </div>
            <div style="margin-top: 12px; text-align: center;">
                <button class="btn btn-sm btn-outline-secondary" onclick="exportarConversacion()">
                    <i class="fas fa-download"></i> Exportar conversaciÃ³n
                </button>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <script>
        $(document).ready(function() {
            // Configurar UTF-8
            $.ajaxSetup({
                contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
                scriptCharset: 'utf-8',
                accepts: {
                    text: 'text/plain; charset=UTF-8',
                    json: 'application/json; charset=UTF-8'
                }
            });
            
            // Scroll al final
            scrollToBottom();
            
            // Focus en input
            $('#mensajeInput').focus();
            
            // Enviar con Enter
            $('#mensajeInput').on('keypress', function(e) {
                if (e.which === 13 && !e.shiftKey) {
                    e.preventDefault();
                    enviarMensaje();
                }
            });
            
            // Enviar con botÃ³n
            $('#btnEnviar').on('click', function() {
                enviarMensaje();
            });
        });
        
        function enviarMensaje() {
            var mensaje = $('#mensajeInput').val().trim();
            
            if (mensaje === '') {
                return;
            }
            
            // Agregar mensaje del USUARIO (derecha)
            agregarMensaje('user', mensaje);
            
            // Limpiar y deshabilitar input
            $('#mensajeInput').val('').prop('disabled', true);
            $('#btnEnviar').prop('disabled', true);
            
            // Mostrar indicador de escritura
            mostrarEscribiendo(true);
            
            // Simular respuesta de IA (aquÃ­ se conectarÃ­a con el backend real)
            setTimeout(function() {
                mostrarEscribiendo(false);
                
                // Respuesta del BOT (izquierda)
                var respuesta = generarRespuestaIA(mensaje);
                agregarMensaje('bot', respuesta);
                
                // Habilitar input
                $('#mensajeInput').prop('disabled', false).focus();
                $('#btnEnviar').prop('disabled', false);
            }, 1500);
        }
        
        function agregarMensaje(tipo, contenido) {
            var hora = new Date().toLocaleTimeString('es-ES', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            var $mensaje = $('<div>')
                .addClass('message ' + tipo)
                .html(
                    '<div class="message-bubble">' +
                        $('<div>').text(contenido).html() + // Escape HTML
                        '<div class="message-time">' + hora + '</div>' +
                    '</div>'
                );
            
            $('#chatMessages').append($mensaje);
            scrollToBottom();
        }
        
        function mostrarEscribiendo(mostrar) {
            if (mostrar) {
                if ($('#typingIndicator').length === 0) {
                    var $typing = $('<div>')
                        .attr('id', 'typingIndicator')
                        .addClass('message bot')
                        .html(
                            '<div class="typing-indicator show">' +
                                '<span class="typing-dot"></span>' +
                                '<span class="typing-dot"></span>' +
                                '<span class="typing-dot"></span>' +
                            '</div>'
                        );
                    $('#chatMessages').append($typing);
                }
            } else {
                $('#typingIndicator').remove();
            }
            scrollToBottom();
        }
        
        function scrollToBottom() {
            var $messages = $('#chatMessages');
            if ($messages.length) {
                $messages.scrollTop($messages[0].scrollHeight);
            }
        }
        
        // Sistema de respuestas inteligente con contexto
        var contextoConversacion = {
            preguntasRealizadas: [],
            sintomasReportados: [],
            contadorPreguntas: 0
        };
        
        function generarRespuestaIA(mensaje) {
            var mensajeLower = mensaje.toLowerCase();
            contextoConversacion.contadorPreguntas++;
            
            // Primera interacciÃ³n - Saludo
            if (contextoConversacion.contadorPreguntas === 1 && 
                (mensajeLower.includes('hola') || mensajeLower.includes('buenas'))) {
                return 'ğŸ‘‹ Â¡Hola! Soy tu asistente mÃ©dico virtual. Estoy aquÃ­ para ayudarte con una evaluaciÃ³n inicial de tus sÃ­ntomas. Â¿QuÃ© molestias presentas hoy?';
            }
            
            // DetecciÃ³n de sÃ­ntomas especÃ­ficos
            if (mensajeLower.includes('tos')) {
                contextoConversacion.sintomasReportados.push('tos');
                if (!contextoConversacion.preguntasRealizadas.includes('tos_tipo')) {
                    contextoConversacion.preguntasRealizadas.push('tos_tipo');
                    return 'ğŸ©º Entiendo que tienes tos. Para ayudarte mejor necesito saber:<br><br>â€¢ Â¿Es una tos seca o con flemas/mucosidad?<br>â€¢ Â¿Hace cuÃ¡nto tiempo tienes la tos?<br>â€¢ Â¿Es mÃ¡s intensa por las noches o durante el dÃ­a?';
                } else {
                    return 'ğŸ“ Perfecto, he registrado tu tos. Â¿Presentas otros sÃ­ntomas como fiebre, dolor de pecho o dificultad para respirar?';
                }
            }
            
            if (mensajeLower.includes('fiebre') || mensajeLower.includes('temperatura') || mensajeLower.includes('calentura')) {
                contextoConversacion.sintomasReportados.push('fiebre');
                if (!contextoConversacion.preguntasRealizadas.includes('fiebre_medida')) {
                    contextoConversacion.preguntasRealizadas.push('fiebre_medida');
                    return 'ğŸŒ¡ï¸ Es importante monitorear la fiebre. Por favor indÃ­came:<br><br>â€¢ Â¿Has medido tu temperatura? Â¿CuÃ¡ntos grados tienes?<br>â€¢ Â¿Desde hace cuÃ¡nto tiempo tienes fiebre?<br>â€¢ Â¿Has tomado algÃºn medicamento para bajarla?';
                } else {
                    return 'âœ… Entendido. La fiebre es un sÃ­ntoma importante. Â¿Tienes otros sÃ­ntomas como dolor muscular, escalofrÃ­os o sudoraciÃ³n?';
                }
            }
            
            if (mensajeLower.includes('dolor') && (mensajeLower.includes('cabeza') || mensajeLower.includes('cerebro'))) {
                contextoConversacion.sintomasReportados.push('dolor_cabeza');
                if (!contextoConversacion.preguntasRealizadas.includes('dolor_cabeza_caracteristicas')) {
                    contextoConversacion.preguntasRealizadas.push('dolor_cabeza_caracteristicas');
                    return 'ğŸ¤• El dolor de cabeza puede tener diversas causas. AyÃºdame con esto:<br><br>â€¢ Â¿El dolor es pulsÃ¡til (late) o es constante?<br>â€¢ Â¿DÃ³nde se localiza? (frente, sienes, nuca)<br>â€¢ Â¿Desde hace cuÃ¡nto lo tienes?<br>â€¢ En escala del 1-10, Â¿quÃ© tan intenso es?';
                } else {
                    return 'ğŸ“‹ He registrado tu dolor de cabeza. Â¿Hay algo mÃ¡s que te moleste? Por ejemplo, Â¿nÃ¡useas, vÃ³mito o sensibilidad a la luz?';
                }
            }
            
            if (mensajeLower.includes('respirar') || mensajeLower.includes('aire') || mensajeLower.includes('ahogar')) {
                contextoConversacion.sintomasReportados.push('dificultad_respiratoria');
                return 'ğŸš¨ <strong>IMPORTANTE:</strong> La dificultad para respirar puede ser seria.<br><br>â€¢ Â¿Puedes hablar oraciones completas sin fatigarte?<br>â€¢ Â¿Tienes dolor en el pecho?<br>â€¢ Â¿Tus labios o dedos se ven azulados?<br><br>âš ï¸ Si es muy severa, considera ir a urgencias de inmediato.';
            }
            
            if (mensajeLower.includes('pecho') && mensajeLower.includes('dolor')) {
                contextoConversacion.sintomasReportados.push('dolor_pecho');
                return 'âš ï¸ El dolor de pecho requiere atenciÃ³n. Necesito saber:<br><br>â€¢ Â¿El dolor es punzante, opresivo o ardiente?<br>â€¢ Â¿Empeora al respirar profundo o toser?<br>â€¢ Â¿Se irradia hacia el brazo, cuello o espalda?<br><br>ğŸš¨ Si el dolor es muy intenso o no puedes respirar bien, acude a urgencias.';
            }
            
            if (mensajeLower.includes('garganta')) {
                contextoConversacion.sintomasReportados.push('dolor_garganta');
                return 'ğŸ˜· El dolor de garganta es comÃºn. Dime:<br><br>â€¢ Â¿Te duele al tragar?<br>â€¢ Â¿Ves tus amÃ­gdalas inflamadas o con placas blancas?<br>â€¢ Â¿Tienes ronquera o te cuesta hablar?<br>â€¢ Â¿Tienes fiebre asociada?';
            }
            
            if (mensajeLower.includes('nariz') || mensajeLower.includes('congestion') || mensajeLower.includes('moco')) {
                contextoConversacion.sintomasReportados.push('congestion_nasal');
                return 'ğŸ¤§ La congestiÃ³n nasal puede ser muy molesta. CuÃ©ntame:<br><br>â€¢ Â¿Es una congestiÃ³n constante o intermitente?<br>â€¢ Â¿El moco es claro, amarillo o verde?<br>â€¢ Â¿Tienes estornudos frecuentes?<br>â€¢ Â¿Has perdido el sentido del olfato o el gusto?';
            }
            
            // Si menciona varios sÃ­ntomas en una frase
            if ((mensajeLower.includes('tos') && mensajeLower.includes('fiebre')) || 
                contextoConversacion.sintomasReportados.length >= 3) {
                return 'ğŸ“Š Has reportado varios sÃ­ntomas. DÃ©jame hacer un resumen para evaluar tu situaciÃ³n:<br><br>' +
                       'âœ“ SÃ­ntomas reportados: ' + contextoConversacion.sintomasReportados.join(', ') + '<br><br>' +
                       'Â¿Desde cuÃ¡ndo comenzaron estos sÃ­ntomas? Â¿Todos al mismo tiempo o fueron apareciendo gradualmente?';
            }
            
            // Respuestas para duraciones
            if (mensajeLower.match(/\d+\s*(dÃ­a|dias|hora|horas|semana|semanas)/)) {
                return 'âœ… Gracias por esa informaciÃ³n. Esto me ayuda a entender mejor tu situaciÃ³n.<br><br>' +
                       'Â¿Hay algo mÃ¡s que consideres importante que deba saber? Por ejemplo:<br>' +
                       'â€¢ Â¿Has estado en contacto con personas enfermas?<br>' +
                       'â€¢ Â¿Tomas algÃºn medicamento actualmente?<br>' +
                       'â€¢ Â¿Tienes alergias conocidas?';
            }
            
            // NÃºmeros (probablemente temperaturas)
            if (mensajeLower.match(/\d+\.?\d*\s*(grados|Â°|c)/)) {
                var temp = parseFloat(mensajeLower.match(/\d+\.?\d*/)[0]);
                if (temp >= 39) {
                    return 'ğŸš¨ <strong>FIEBRE ALTA:</strong> Una temperatura de ' + temp + 'Â°C es alta.<br><br>' +
                           'âš ï¸ <strong>RecomendaciÃ³n urgente:</strong><br>' +
                           'â€¢ Acude a urgencias o consulta mÃ©dica HOY<br>' +
                           'â€¢ Mientras tanto, toma abundante lÃ­quido<br>' +
                           'â€¢ Puedes tomar un antipirÃ©tico (paracetamol)<br><br>' +
                           'Â¿Tienes otros sÃ­ntomas que deba conocer?';
                } else if (temp >= 38) {
                    return 'ğŸŒ¡ï¸ Temperatura de ' + temp + 'Â°C (fiebre moderada). <br><br>' +
                           'ğŸ’Š <strong>Recomendaciones:</strong><br>' +
                           'â€¢ Mantente bien hidratado<br>' +
                           'â€¢ Descansa adecuadamente<br>' +
                           'â€¢ Considera programar cita mÃ©dica en 24-48h<br><br>' +
                           'Â¿Presentas otros sÃ­ntomas ademÃ¡s de la fiebre?';
                } else {
                    return 'âœ… Tu temperatura de ' + temp + 'Â°C estÃ¡ en rango normal o subfebril.<br><br>' +
                           'Â¿QuÃ© otros sÃ­ntomas te preocupan?';
                }
            }
            
            // Respuestas afirmativas/negativas
            if (mensajeLower.match(/^(si|sÃ­|no|nada|ninguno|ningun)/)) {
                return 'ğŸ“ Entendido. BasÃ¡ndome en lo que me has contado, necesito un poco mÃ¡s de informaciÃ³n para darte una mejor evaluaciÃ³n.<br><br>' +
                       'Â¿PodrÃ­as describirme todos los sÃ­ntomas que presentas actualmente y desde hace cuÃ¡nto tiempo?';
            }
            
            // Respuesta genÃ©rica mejorada
            return 'ğŸ¤” Entiendo tu consulta. Para poder ayudarte de la mejor manera, necesito que me des mÃ¡s detalles especÃ­ficos sobre:<br><br>' +
                   'â€¢ Â¿QuÃ© sÃ­ntomas exactos presentas?<br>' +
                   'â€¢ Â¿Desde hace cuÃ¡nto tiempo los tienes?<br>' +
                   'â€¢ Â¿QuÃ© tan intensos son (leve, moderado, severo)?<br><br>' +
                   'Cuanto mÃ¡s especÃ­fico seas, mejor podrÃ© orientarte. ğŸ˜Š';
        }
        
        function exportarConversacion() {
            alert('Funcionalidad de exportaciÃ³n en desarrollo. Se guardarÃ¡ el historial del chat.');
        }
    </script>
}
